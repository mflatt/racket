
srcdir = @srcdir@

CC = @CC@
CFLAGS = @CFLAGS@ @CPPFLAGS@

RKTIO_HEADERS = $(srcdir)/rktio.h $(srcdir)/rktio_private.h rktio_config.h

OBJS = rktio_filesystem.o \
       rktio_read_write.o \
       rktio_poll_set.o \
       rktio_ltps.o \
       rktio_network.o \
       rktio_error.o \
       rktio_main.o

all: $(OBJS)

demo: $(OBJS) main.o demo_fifo
	$(CC) -o demo $(CFLAGS) $(LDFLAGS) main.o $(OBJS)

demo_fifo:
	mkfifo demo_fifo

rktio_filesystem.o: $(srcdir)/rktio_filesystem.c $(RKTIO_HEADERS)
	$(CC) $(CFLAGS) -I$(srcdir) -I. -o rktio_filesystem.o -c $(srcdir)/rktio_filesystem.c

rktio_read_write.o: $(srcdir)/rktio_read_write.c $(RKTIO_HEADERS)
	$(CC) $(CFLAGS) -I$(srcdir) -I. -o rktio_read_write.o -c $(srcdir)/rktio_read_write.c

rktio_poll_set.o: $(srcdir)/rktio_poll_set.c $(RKTIO_HEADERS)
	$(CC) $(CFLAGS) -I$(srcdir) -I. -o rktio_poll_set.o -c $(srcdir)/rktio_poll_set.c

rktio_ltps.o: $(srcdir)/rktio_ltps.c $(RKTIO_HEADERS)
	$(CC) $(CFLAGS) -I$(srcdir) -I. -o rktio_ltps.o -c $(srcdir)/rktio_ltps.c

rktio_network.o: $(srcdir)/rktio_network.c $(RKTIO_HEADERS)
	$(CC) $(CFLAGS) -I$(srcdir) -I. -o rktio_network.o -c $(srcdir)/rktio_network.c

rktio_error.o: $(srcdir)/rktio_error.c $(RKTIO_HEADERS)
	$(CC) $(CFLAGS) -I$(srcdir) -I. -o rktio_error.o -c $(srcdir)/rktio_error.c

rktio_main.o: $(srcdir)/rktio_main.c $(RKTIO_HEADERS)
	$(CC) $(CFLAGS) -I$(srcdir) -I. -o rktio_main.o -c $(srcdir)/rktio_main.c

main.o: $(srcdir)/main.c $(RKTIO_HEADERS)
	$(CC) $(CFLAGS) -I$(srcdir) -I. -o main.o -c $(srcdir)/main.c
